{% extends "base.html" %}
{% load static %}

{% block title %}新規登録 | CocoLink{% endblock %}
{% block page_title %}新規登録{% endblock %}

{% block content %}
<div class="register-container" style="max-width: 400px; margin: 0 auto; padding: 40px; border: 1px solid #ccc; border-radius: 10px; background-color: #fff;">
    <h2 style="text-align: center; margin-bottom: 30px;">CocoLink<br>新規登録</h2>

    <form method="post" action="{% url 'register' %}">
        {% csrf_token %}
        <!-- ① 入力欄 -->
        <div style="margin-bottom: 15px;">
            <label for="name">名前：</label><br>
            <input type="text" id="name" name="name" required style="width:100%; padding:8px;">
        </div>

        <div style="margin-bottom: 15px;">
            <label for="age">年齢：</label><br>
            <input type="number" id="age" name="age" value="65" min="65" required 
                style="width:100%; padding:8px; -moz-appearance: textfield; appearance: textfield;">
            <span id="ageError" style="color:red; display:none;">年齢は65以上で入力してください。</span>
        </div>


        <!-- ② 性別プルダウン -->
        <div style="margin-bottom: 15px;">
            <label for="gender">性別：</label><br>
            <select id="gender" name="gender" style="width:100%; padding:8px;">
                <option value="">選択</option>
                <option value="male">男性</option>
                <option value="female">女性</option>
                <option value="other">その他</option>
            </select>
        </div>

        <div style="margin-bottom: 15px;">
            <label for="address">住所：</label><br>
            <input type="address" id="address" name="address" required style="width:100%; padding:8px;">
        </div>

        <div style="margin-bottom: 15px;">
            <label for="email">メールアドレス：</label><br>
            <input type="email" id="email" name="email" required style="width:100%; padding:8px;">
        </div>

        <div style="margin-bottom: 25px;">
            <label for="password">パスワード：</label><br>
            <input type="password" id="password" name="password" required style="width:100%; padding:8px;">
        </div>

        <!-- 登録ボタン（クリックでポップアップを開く） -->
        <div style="text-align:center;">
            <button type="button" onclick="openPopup()" style="padding:10px 30px; background-color:#4CAF50; color:#fff; border:none; border-radius:5px; cursor:pointer;">
                登録
            </button>
        </div>
    </form>
</div>

<!-- ===== ポップアップエリア ===== -->
<div id="popup-overlay" style="display:none; justify-content:center; align-items:center; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">
    <div style="background:white; padding:30px; border-radius:10px; text-align:center; width:300px;">
        <p style="margin-bottom:20px;">この内容で登録しますか？</p>
        <button onclick="submitForm()" style="margin-right:10px; padding:8px 20px; background-color:#4CAF50; color:#fff; border:none; border-radius:5px; cursor:pointer;">はい</button>
        <button onclick="closePopup()" style="padding:8px 20px; background-color:#aaa; color:#fff; border:none; border-radius:5px; cursor:pointer;">キャンセル</button>
    </div>
</div>

<!-- ===== スクリプト部分 ===== -->
<script>
// ===== ポップアップを開く =====
function openPopup() {
    const popup = document.getElementById("popup-overlay");
    if (popup) {
        popup.style.display = "flex";
    } else {
        console.error("popup-overlay が見つかりません");
    }
}

// ===== ポップアップを閉じる =====
function closePopup() {
    const popup = document.getElementById("popup-overlay");
    if (popup) {
        popup.style.display = "none";
    } else {
        console.error("popup-overlay が見つかりません");
    }
}

// ===== 「はい」でフォーム送信 =====
function submitForm() {
    closePopup(); // 先に閉じる
    document.getElementById("register-form").submit();
}
</script>
{% endblock %}
